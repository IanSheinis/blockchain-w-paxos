⚠️ p4.json not found
============================================================
Starting Process P4
============================================================

Process P4: Server listening on port 9998
Process P4: Received PREPARE from P1
Current acceptor.prepare
bal: 0
self.BallotNum: -1
proposer_depth: 1
depth: 0
Sending response: {'type': 'PREPARE_PROMISE', 'from': 'P4', 'ballot_num': 0, 'accepted_ballot': -1, 'accepted_value': {}}
Process P4: Received PREPARE from P2
Current acceptor.prepare
bal: 0
self.BallotNum: 0
proposer_depth: 1
depth: 0
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 0, 'promised_ballot': 0}
Process P4: Received PREPARE from P3
Current acceptor.prepare
bal: 0
self.BallotNum: 0
proposer_depth: 1
depth: 0
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 0, 'promised_ballot': 0}
Process P4: Received transaction from master
Process P4: Proposing new block with transaction Transaction(sender_id='P4', receiver_id='P5', amount=10)
P4 has blockchain as none
Process P4: Starting PREPARE with ballot 0
Process P4: Received ACCEPT from P1
Process P4: ACCEPTED ballot 0, value (full blockchain not just block): '{'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': True}]}'
Process P4: Initializing blockchain with length 1
✓ Rebuilt balances from 1 blocks
Process P4: Blockchain updated! New length: 1
✓ Blockchain saved to p4.json
Sending response: {'type': 'ACCEPT_ACCEPTED', 'from': 'P4', 'ballot_num': 0, 'accepted_value': {'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': True}]}}
Process P4: Received PREPARE from P5
Current acceptor.prepare
bal: 0
self.BallotNum: 0
proposer_depth: 2
depth: 1
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 0, 'promised_ballot': 0}
Process P4: Can't reach majority, stopping early
Process P4: PREPARE failed (0/2)
 Highest ballot received: 0
Process P4: Block proposal failed ❌❌❌
P4 out of loop, will wait 19.44764871270938
Current transaction queue deque([Transaction(sender_id='P4', receiver_id='P5', amount=10)])
Process P4: Received DECISION from P1
Process P4: Processing DECISION from P1, ballot 0
Process P4: Updating blockchain from length 1 to 1
✓ Rebuilt balances from 1 blocks
Process P4: Blockchain updated! New length: 1
✓ Blockchain saved to p4.json
Process P4: Resetting proposer state and cancelling tasks
Process P4: Proposer reset complete
Process P4: Proposing new block with transaction Transaction(sender_id='P4', receiver_id='P5', amount=10)
Process P4: Starting PREPARE with ballot 0
Process P4: Received PREPARE from P2
Current acceptor.prepare
bal: 0
self.BallotNum: -1
proposer_depth: 2
depth: 1
Sending response: {'type': 'PREPARE_PROMISE', 'from': 'P4', 'ballot_num': 0, 'accepted_ballot': -1, 'accepted_value': {}}
Process P4: Received PREPARE from P3
Current acceptor.prepare
bal: 0
self.BallotNum: 0
proposer_depth: 2
depth: 1
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 0, 'promised_ballot': 0}
Process P4: Received PREPARE from P5
Current acceptor.prepare
bal: 0
self.BallotNum: 0
proposer_depth: 2
depth: 1
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 0, 'promised_ballot': 0}
Process P4: Can't reach majority, stopping early
Process P4: PREPARE failed (0/2)
 Highest ballot received: 0
Process P4: Block proposal failed ❌❌❌
P4 out of loop, will wait 19.765749984531595
Current transaction queue deque([Transaction(sender_id='P4', receiver_id='P5', amount=10)])
Process P4: Received ACCEPT from P2
Process P4: ACCEPTED ballot 0, value (full blockchain not just block): '{'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}'
Process P4: Updating blockchain from length 1 to 2
✓ Rebuilt balances from 2 blocks
Process P4: Blockchain updated! New length: 2
✓ Blockchain saved to p4.json
Sending response: {'type': 'ACCEPT_ACCEPTED', 'from': 'P4', 'ballot_num': 0, 'accepted_value': {'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}}
Process P4: Received DECISION from P2
Process P4: Received PREPARE from P3
Current acceptor.prepare
bal: 1
self.BallotNum: 0
proposer_depth: 3
depth: 2
Sending response: {'type': 'PREPARE_PROMISE', 'from': 'P4', 'ballot_num': 1, 'accepted_ballot': 0, 'accepted_value': {'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}}
Process P4: Proposing new block with transaction Transaction(sender_id='P4', receiver_id='P5', amount=10)
Process P4: Starting PREPARE with ballot 1
Process P4: Received ACCEPT from P3
Process P4: ACCEPTED ballot 1, value (full blockchain not just block): '{'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}'
Process P4: Updating blockchain from length 2 to 2
✓ Rebuilt balances from 2 blocks
Process P4: Blockchain updated! New length: 2
✓ Blockchain saved to p4.json
Sending response: {'type': 'ACCEPT_ACCEPTED', 'from': 'P4', 'ballot_num': 1, 'accepted_value': {'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}}
Process P4: Can't reach majority, stopping early
Process P4: PREPARE failed (0/2)
 Highest ballot received: 1
Process P4: Block proposal failed ❌❌❌
P4 out of loop, will wait 18.651946119490837
Current transaction queue deque([Transaction(sender_id='P4', receiver_id='P5', amount=10)])
Process P4: Proposing new block with transaction Transaction(sender_id='P4', receiver_id='P5', amount=10)
Process P4: Starting PREPARE with ballot 2
Process P4: Received PREPARE from P5
Current acceptor.prepare
bal: 1
self.BallotNum: 1
proposer_depth: 3
depth: 2
Sending response: {'type': 'PREPARE_REJECT', 'from': 'P4', 'ballot_num': 1, 'promised_ballot': 1}
Process P4: Received DECISION from P3
Process P4: Got promise #1 from P1
Process P4: Got promise #2 from P3
Process P4: Got majority (2/2)!
Process P4: PREPARE succeeded with 2 promises
Process P4: Starting ACCEPT with ballot 2, value '{'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}]}'
Process P4: Got accepted #1 from P3
Process P4: Got accepted #2 from P5
Process P4: Got majority accepts (2/2)!
Process P4: ACCEPT succeeded with 2 accepts
Process P4: Sending DECISION messages with ballot 2
Process P4: Sent DECISION to P2
Process P4: Sent DECISION to P1
Process P4: Sent DECISION to P3
Process P4: Sent DECISION to P5
Process P4: All DECISION messages sent
Process P4: Block proposal succeeded! ✅✅✅
Process P4: Updating blockchain from length 2 to 2
✓ Rebuilt balances from 2 blocks
Process P4: Blockchain updated! New length: 2
✓ Blockchain saved to p4.json
Process P4: Resetting proposer state and cancelling tasks
Process P4: Proposer reset complete
Success in proposing loop
P4 out of loop, will wait 16.395261488299713
Current transaction queue deque([])
Queue is empty, returning
Queue is empty, returning
Process P4: Processing DECISION from P2, ballot 0
Process P4: Updating blockchain from length 2 to 2
✓ Rebuilt balances from 2 blocks
Process P4: Blockchain updated! New length: 2
✓ Blockchain saved to p4.json
Process P4: Resetting proposer state and cancelling tasks
Process P4: Proposer reset complete
Queue is empty, returning
Process P4: Processing DECISION from P3, ballot 1
Process P4: Updating blockchain from length 2 to 2
✓ Rebuilt balances from 2 blocks
Process P4: Blockchain updated! New length: 2
✓ Blockchain saved to p4.json
Process P4: Resetting proposer state and cancelling tasks
Process P4: Proposer reset complete
Queue is empty, returning
Process P4: Received PREPARE from P5
Current acceptor.prepare
bal: 3
self.BallotNum: -1
proposer_depth: 3
depth: 2
Sending response: {'type': 'PREPARE_PROMISE', 'from': 'P4', 'ballot_num': 3, 'accepted_ballot': -1, 'accepted_value': {}}
Process P4: Received ACCEPT from P5
Process P4: ACCEPTED ballot 3, value (full blockchain not just block): '{'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}, {'sender_id': 'P5', 'receiver_id': 'P1', 'amount': 10, 'hash_pointer': 'c7911ba0c52bc1ac095d3ea02bc7d0707dda207a12087eedfd0ad2b0eb8123de', 'nonce': 'YxO1q6qkezqL88PX', 'hash_result': '3b369357b733724a2e0010a7c3475ccd99e26c9d3af87ddd46f406ee265ecdc0', 'tentative': True}]}'
Process P4: Updating blockchain from length 2 to 3
✓ Rebuilt balances from 3 blocks
Process P4: Blockchain updated! New length: 3
✓ Blockchain saved to p4.json
Sending response: {'type': 'ACCEPT_ACCEPTED', 'from': 'P4', 'ballot_num': 3, 'accepted_value': {'blockchain': [{'sender_id': 'P1', 'receiver_id': 'P2', 'amount': 10, 'hash_pointer': '0000000000000000000000000000000000000000000000000000000000000000', 'nonce': 'Zh9hV3GpbFNCTKuY', 'hash_result': '09762baa5895bead94a95fd9f43deedbc41d01da2d7f1959b75fc1a0254dd1a1', 'tentative': False}, {'sender_id': 'P2', 'receiver_id': 'P3', 'amount': 10, 'hash_pointer': 'eaf50615b70aba26c0de874b10a7595e4f8029cfaa0f9b58961a8f282fcbb45b', 'nonce': 'OEtJ7TFYLtmXwPdm', 'hash_result': '4a6b9266060c9f9c4d5e382a31c7e97d1c479975910cac518ffc1493d6d4eaa4', 'tentative': True}, {'sender_id': 'P5', 'receiver_id': 'P1', 'amount': 10, 'hash_pointer': 'c7911ba0c52bc1ac095d3ea02bc7d0707dda207a12087eedfd0ad2b0eb8123de', 'nonce': 'YxO1q6qkezqL88PX', 'hash_result': '3b369357b733724a2e0010a7c3475ccd99e26c9d3af87ddd46f406ee265ecdc0', 'tentative': True}]}}
Process P4: Received DECISION from P5
Process P4: Processing DECISION from P5, ballot 3
Process P4: Updating blockchain from length 3 to 3
✓ Rebuilt balances from 3 blocks
Process P4: Blockchain updated! New length: 3
✓ Blockchain saved to p4.json
Process P4: Resetting proposer state and cancelling tasks
Process P4: Proposer reset complete
Queue is empty, returning
